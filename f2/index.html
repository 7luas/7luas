<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portfolio (v1.03)</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@300&display=swap');
        body { font-family: 'Roboto', sans-serif; margin: 0; padding: 0; text-align: center; }
        .filters { margin: 10px 0; }
        .filters button { margin: 2px; padding: 5px 10px; font-size: 12px; text-transform: uppercase; cursor: pointer; border: none; background: #ccc; }
        .filters button.active { background: blue; color: white; }
        .count { font-size: 14px; margin-bottom: 10px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 0; }
        .tile { position: relative; overflow: hidden; border: 2px solid transparent; }
        .tile img, .tile video { width: 100%; height: auto; display: block; }
        .tile.featured { border-color: red; }
        .overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); color: white; opacity: 0; transition: opacity 0.3s; display: flex; flex-direction: column; justify-content: center; align-items: center; }
        .tile:hover .overlay { opacity: 1; }
        .footer { margin-top: 20px; font-size: 12px; color: gray; }
    </style>
</head>
<body>
    <p>Lorem ipsum lorem ipsum ipsum lorem ipsum ipsum lorem ipsum.</p>
    <div class="filters">
        <button id="all" class="active">ALL</button>
        <button id="featured">FEATURED</button>
        <div id="tag-buttons" style="display:inline;"></div>
    </div>
    <p class="count" id="project-count"></p>
    <div class="grid" id="project-grid"></div>
    <p class="footer">&copy; 2025 Portfolio</p>
    <script>
        let projects = [];
        let activeFilters = { all: true, featured: false, tags: [] };

        async function loadProjects() {
            const response = await fetch('data.json');
            const data = await response.json();
            projects = data.projects;
            generateTagButtons();
            renderProjects();
        }

        function generateTagButtons() {
            const tags = [...new Set(projects.flatMap(p => p.tags))];
            const container = document.getElementById('tag-buttons');
            container.innerHTML = '';
            tags.forEach(tag => {
                const button = document.createElement('button');
                button.textContent = tag.toUpperCase();
                button.onclick = () => toggleTagFilter(tag);
                container.appendChild(button);
            });
        }

        function toggleTagFilter(tag) {
            activeFilters.all = false;
            activeFilters.featured = false;
            const index = activeFilters.tags.indexOf(tag);
            if (index === -1) activeFilters.tags.push(tag);
            else activeFilters.tags.splice(index, 1);
            updateButtonStates();
            renderProjects();
        }

        function updateButtonStates() {
            document.getElementById('all').classList.toggle('active', activeFilters.all);
            document.getElementById('featured').classList.toggle('active', activeFilters.featured);
            document.querySelectorAll('#tag-buttons button').forEach(btn => {
                btn.classList.toggle('active', activeFilters.tags.includes(btn.textContent.toLowerCase()));
            });
        }

        function renderProjects() {
            const container = document.getElementById('project-grid');
            container.innerHTML = '';
            let filtered = projects.filter(p =>
                activeFilters.all ||
                (activeFilters.featured && p.featured) ||
                activeFilters.tags.some(tag => p.tags.includes(tag))
            );
            filtered.sort((a, b) => b.featured - a.featured);
            filtered.forEach(proj => {
                const tile = document.createElement('div');
                tile.classList.add('tile');
                if (proj.featured) tile.classList.add('featured');
                const media = proj.mainMedia.endsWith('.mp4')
                    ? `<video src="media/${proj.mainMedia}" autoplay loop muted></video>`
                    : `<img src="media/${proj.mainMedia}" alt="${proj.name}">`;
                const overlay = `
                    <div class="overlay">
                        <p>${proj.name} (${proj.projectContent.length})</p>
                        <p>${proj.description}</p>
                        <p>${proj.tags.map(t => `<span>${t}</span>`).join(' ')}</p>
                    </div>`;
                tile.innerHTML = media + overlay;
                container.appendChild(tile);
            });
            document.getElementById('project-count').textContent = `${filtered.length} projects shown`;
        }

        document.getElementById('all').onclick = () => {
            activeFilters = { all: true, featured: false, tags: [] };
            updateButtonStates();
            renderProjects();
        };
        
        document.getElementById('featured').onclick = () => {
            activeFilters = { all: false, featured: true, tags: [] };
            updateButtonStates();
            renderProjects();
        };

        loadProjects();
    </script>
</body>
</html>
